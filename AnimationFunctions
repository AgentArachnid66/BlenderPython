import bpy
from enum import Enum

class TransformType(Enum):
    Location = "location"
    Rotation = "rotation_quaternion"
    Scale = "scale"


def GetFCurve(bone, transformType ,axis):
    obj = bpy.context.object
    curves = obj.animation_data.action.fcurves.values()
    for fcurve in curves:
        
        if fcurve.data_path.startswith("pose.bones"):
            try: 
                tmp = fcurve.data_path.split("[", maxsplit=1)[1].split("]", maxsplit=1)
                bone_name = tmp[0][1:-1]
                keyframe_type = tmp[1][1:]
                
                fcurve.select = False


                if((bone_name == bone) and (keyframe_type == transformType.value) and (fcurve.array_index == GetRotationIndex(axis))):
                    activeCurve = fcurve
                    
                    
                    
            except IndexError:
                continue
    if(activeCurve):
        return activeCurve
            
    
def GetRotationIndex(axis):
    dict = {
    "W": 0,
    "X": 1,
    "Y": 2,
    "Z": 3
    }
    
    return dict.get(axis, "Invalid")

def CleanupTransform(bone, type ,axis, start_frame, end_frame, min, max):
    activeCurve = GetFCurve(bone,type, axis)
    if(activeCurve):
        activeCurve.select = True
        activeCurve.hide = False
        keyframes = activeCurve.keyframe_points.values()
        
        for frame in keyframes:
            if ((frame.co[0] > start_frame) and (frame.co[0] < end_frame)):
                frame.select_control_point = True
                if(frame.co[1] < min):
                    frame.co[1] = min
                elif(frame.co[1] > max):
                    frame.co[1] = max

    
print(TransformType.Location.value)

CleanupTransform("LeftForeArm", TransformType.Rotation, "Z", 1, 10, -1, 0)

def TranslateKeyframes(bone, type, axis, start_frame, end_frame, delta_x, delta_y):
    activeCurve = GetFCurve(bone,type, axis)
    if(activeCurve):
        activeCurve.select = True
        activeCurve.hide = False
        keyframes = activeCurve.keyframe_points.values()
        
        for frame in keyframes:
            if ((frame.co[0] > start_frame) and (frame.co[0] < end_frame)):
                frame.select_control_point = True
                
                frame.co[0] += delta_x
                frame.co[1] += delta_y
   
TranslateKeyframes("LeftForeArm", TransformType.Rotation, "Z", 70, 100, 0, 0)
